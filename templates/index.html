<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Wikipedia Chronological Ordering Demo</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style>
    .rcorners {
    border-radius: 25px;
    border: 2px solid #48DDCC;
    padding: 20px;
    width: 60%;
    height: auto;
    align-items: : center;
}
.rcorners2 {
border-radius: 25px;
border: 2px solid #48DDCC;
padding: 20px;
width: 60%;
height: 1000px;
align-items: : center;
}


    </style>
  </head>
  <body>
    <h3 align="center">Wikipedia Chronological Search</h2>
      <div class="rcorners" align="center" style="width:800px; margin:0 auto;">
        <p style="font-family:courier;" align="left" >
          This page is a demonstration of Wikipedia Chronological Search.<br>
          Enter a text and the application will search the Wikipedia, come up with a page, find events from the page and sort these events by importance using TF-IDF and then show the top 10 results sorted by chronological order (Latest comes last). If there are multiple Wikipedia pages, you'll be asked to select one of the options from a dropdown.<br>
          Source code is publicly available at <a href="https://github.com/piyush-kgp/wikipedia-chronological-search">https://github.com/piyush-kgp/wikipedia-chronological-search</a>
          <br>
          <b>Technologies used:</b>
            <ul align="left">
              <li>
                <a href="https://www.python.org/">Python</a> Backend - <a href="http://flask.pocoo.org/">Flask</a>, <a href="http://www.nltk.org/">NLTK</a>, <a href="https://scikit-learn.org">Scikit-Learn</a>,   <a href="https://wikipedia.readthedocs.io/">Wikipedia</a></li>
              <li>HTML Frontend - <a href="https://jquery.com/">JQuery</a>, <a href="https://www.javascript.com/">JS</a></li>
        </ul>
        </p>
      </div>
    <div class="rcorners" align="center" style="width:800px; margin:0 auto;">
      <form id="optionForm">
        <input type="text" name="" id="search_text">
        <button type="button" id="submit_text">Submit</button>
      </form>
      <div id="optiondiv">

      </div>
    </div>
    <div class="rcorners2" id="results" align="center" style="width:800px; margin:0 auto;">

    </div>
  </body>
  <script type="text/javascript">
  $(document).ready(function () {
    $("#submit_text").click(function () {
      var search_text = $("#search_text").val();
      console.log(search_text);
      $("#results").html('');
      $("#optiondiv").html('');
      $.ajax({
          url: `/search`,
          contentType: "application/json",
          type: 'POST',
          dataType: 'json',
          data: JSON.stringify({
            search_text: search_text
          }),
          success: function (data) {
            $("#results").html('');
            console.log(data);
            var valid_search = data.valid_search;
            if (valid_search==true){
              var event_df = data.event_df;
              $("#results").append(event_df);
            }else {
              var search_result = data.search_result;
              console.log('the search_results', search_result);

              var searches = "<select id = 'option_texts'>  <option>Select an option"
              for (var i = 0; i < Math.min(search_result.length, 10); i++) {
                // searches = searches + "<a href = 'https://google.com' >" + search_result[i] + "</a><br>";
                searches = searches + "  <option value='" + search_result[i] + "'>" + search_result[i]+ "</option>'";
              }
              searches = searches + "</select>";
              console.log(searches);
              $("#optiondiv").append("<br><p align = 'left'><b>There are multiple wikipedia articles with that word. Please select an option from the dropdown.</b></p><br>" + searches);
              $("#option_texts").change(function(){
                console.log("The text has been changed.");
                var search_text = $("#option_texts").val();
                console.log(search_text);
                $.ajax({
                    url: `/search`,
                    contentType: "application/json",
                    type: 'POST',
                    dataType: 'json',
                    data: JSON.stringify({
                      search_text: search_text
                    }),
                    success: function (data) {
                      $("#results").html('');
                      console.log(data);
                        var event_df = data.event_df;
                        $("#results").append(event_df);
                      }
                    })


              });



            }
            }
            })
    })
  })

  </script>
</html>
